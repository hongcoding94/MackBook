## 002. Docker & Oracle M1에서 사용 해보기

#### 왜? Docker를 이용하여 Oracle를 써야하는가?

- 왜 안될까 StackOverFlow에서 찾아본 결과 
   1. Oracle Database is not supported on ARM processors, only Intel. See here : [링크](https://github.com/oracle/docker-images/issues/1814)
   2. Oracle Database Docker images are only supported with Oracle Linux 7 or Red Hat Enterprise Linux 7 as the host OS.<br/>See here : [링크](https://github.com/oracle/docker-images/tree/main/OracleDatabase/SingleInstance)
   
      ```text
      Oracle Database ... is supported for Oracle Linux 7 and Red Hat Enterprise Linux (RHEL) 7. 
      For more details please see My Oracle Support note: Oracle Support for Database 
      Running on Docker (Doc ID 2216342.1)
      ```

- 요약
  - Oracle은 intal기반으로 Mac은 지원하지 않기 때문이다.
  - Oracle를 지원 받으려면 위 내용과 동일하게 아래와 같은 상황에서만 사용이 가능하다
    |환경|OS버전|
    |---|---|
    |Linux|7버전 이하(Catalina(Santa)7.0)|
    |Window|전 Window 기반 지원|

#### 설치 과정

- docker Oracle 설치 내용 보기
  - docker 명령어 순서
  
  1. docker oracle 설치 여부 확인 및 다운로드
  ```script
  docker search oracle-xe-11g
  docker pull jaspeen/oracle-xe-11g
  docker pull deepdiver/docker-oracle-xe-11g docker run –name oracle11g -d -p 49160:22 -p 49161:1521 deepdiver/docker-oracle-xe-11g
  ```
  2. dokcer Oracle 실행
  ```script
  docker run --name oracle11g -d -p 1521:1521 jaspeen/oracle-xe-11g
  ```
  3. docker Oracle 이미지 실행
  ```script
  $ docker exec -it oracle11g sqlplus
  docker exec -it 82d06175a4c1 bin/bash sqlplus /nolog conn sys/oracle as sysdba
  ```

- Oracle Developer를 설치 후 발생 된 error 및 기타
  - ORA-12547 TNS lost contact 발생
    ```text
    원문 
    Troubleshooting the ORA-12547 error:
     - Check to ensure that the instance is running
     - try to connect locally AS SYSDBA

    Possible solutions to to the ORA-12547 error include:
     - Bad kernel parameters settings (e.g. "ulimit" set too small)
     - Incorrect permissions on the ORACLE executable ($ORACLE_HOME/bin/oracle.exe)
     - $ORACLE_HOME/rdbms/lib/config.o is 0 bytes
     - Oracle binaries have not been linked correctly

    번역
    ORA-12547 오류 문제 해결:
     - 인스턴스가 실행 중인지 확인합니다.
     - 로컬 ASSDBA로 연결 시도

    ORA-12547 오류에 대한 가능한 해결책은 다음과 같습니다.
     - 잘못된 커널 매개 변수 설정(예: "ulimit"이 너무 작게 설정됨)
     - ORACLE 실행 파일에 대한 잘못된 사용 권한($ORACLE_HOME/bin/oracle.exe)
     - $ORACLE_HOME/rdbms/lib/config.o는 0바이트입니다.
     - Oracle 이진 파일이 올바르게 연결되지 않았습니다.
    ``` 
    ※ 해당 내용 [출처](http://www.dba-oracle.com/t_ora_12547_tns_lost_contact.htm)

--

방금 Colima를 사용하면 된다고 하는데 
한번 더 찾아봐야겠다.

--

#### 결론

 Oracle의 폐쇄성과 M1 칩셋의 이슈로 인한 Docker를 이용한 Oracle 사용은 불가능 하다.<br/>
 Oracle를 사용할 수 있는 방법은 두가지로 구분된다.
 
  1. Oracle Cloud를 이용하여 사용<br/>
    ※ Oracle Free Cloud Database 설치 설명 방법 → [클릭](https://www.youtube.com/watch?v=3RJ5jMi8YUQ)<br/>
    
  2. Ubumtu를 이용하여 Oracle을 사용<br/>
    ※ UTM Virtual Machines(비용이 발생 $899) 우분투를 사용한 Oracle사용 영상 → [클릭](https://www.youtube.com/watch?v=eUKhW1Gde-A&t=6s)


#### 한줄평

&nbsp;&nbsp;&nbsp; MySQL만 해야하는 것인가..?

#### 참고 내용

1. [Oracle 12c docker setup on Apple M1](https://stackoverflow.com/questions/68605011/oracle-12c-docker-setup-on-apple-m1)
2. [ORA-12547의 ](http://www.dba-oracle.com/t_ora_12547_tns_lost_contact.htm)
3. [oracle DB XE 21c M1 맥북에서 설치 불가](https://emflant.tistory.com/275)
4. [Apple Silicon m1 맥북에서 Oracle Database 사용하기](https://shanepark.tistory.com/208)
5. [오라클 클라우드 DB 생성](https://ssdragon.tistory.com/41)

---
<div align="center">
  <b>긴 글 읽어주셨어 감사합니다.</b><br/><br/>
  내용에 문제가 있다면 이슈를 통해 알려주신다면 <br>
  감사하겠습니다.
</div>
